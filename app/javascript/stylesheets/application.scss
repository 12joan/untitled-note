@import "./react-tags";
@import "./actiontext";

$enable-negative-margins: true;
$enable-cssgrid: true;
$transition-collapse: none;
$offcanvas-transition-duration: 0.3s;
$offcanvas-horizontal-width: 300px;
$carousel-transition-duration: 0.3s;

@import "bootstrap/scss/bootstrap";

html, body {
  height: 100%;
  word-break: break-word;
  overflow-wrap: break-word;
  overflow-wrap: anywhere;
}

.layout-column, .layout-row {
  @extend .d-flex;
}

.layout-column {
  @extend .flex-column;
}

// Bootstrap Icons
.bi {
  vertical-align: -.125em;
}

.btn-light {
  @extend .bg-white;
  @extend .border;

  &:hover, &:focus {
    @extend .bg-light;
  }
}

.btn-link {
  @extend .p-0;
  @extend .align-baseline;
}

.btn-icon {
  @extend .px-2;
  @extend .py-1;

  &.btn-icon-inline {
    @extend .my-n1;
  }

  &:hover, &:focus {
    @extend .dimmed;
  }
}

.mw-fit-content {
  min-width: fit-content !important;
}

.flex-1 {
  flex: 1;
}

.placeholder {
  background-color: $gray-300;
}

.focused {
  box-shadow: $input-focus-box-shadow;
  outline: none;
}

kbd {
  @extend .border;
  @extend .bg-light;
  @extend .text-dark;

  display: inline-block;
  text-align: center;
  min-width: 2em;
}

.dropdown-item {
  &.dropdown-item-danger {
    &:active {
      @extend .bg-danger;
      @extend .text-white;
    }

    &:not(:active) {
      @extend .text-danger;
    }
  }
}

@mixin btn-selectable($selected-selector) {
  &:not(#{$selected-selector}) {
    @extend .btn-light;
  }

  &#{$selected-selector} {
    @extend .btn-primary;
  }
}

.btn-project {
  @extend .text-start;
  @include btn-selectable('.selected');
}

.dimmed {
  background-color: rgba(0, 0, 0, 100% - lightness($light));
}

#sidebar {
  &:not(.offcanvas) {
    width: $offcanvas-horizontal-width;
  }
}

.navigation-menu {
  .navigation-menu-item {
    &:focus {
      @extend .focused;
    }

    &.active {
      @extend .bg-primary;
      @extend .text-white;
    }

    &:not(.active) {
      @extend .text-dark;

      &:hover, &:focus {
        @extend .dimmed;
      }
    }
  }
}

.document-grid-tile {
  position: relative;

  &:focus-within .document-grid-tile-card {
    @extend .focused;
  }

  &:hover, &:focus-within {
    .document-grid-tile-card:not(.placeholder) {
      @extend .bg-light;
    }
  }

  .document-grid-tile-card {
    @extend .card;
    @extend .card-body;
    @extend .ratio;
    @extend .ratio-16x9;

    overflow: hidden;
    border-radius: 1rem;

    .document-grid-tile-preview {
      @extend .p-3;

      position: absolute;
      top: 0.5rem;
      left: -50%;
      width: 200%;
      height: 200%;

      transform: scale(0.5);
      transform-origin: top;
      pointer-events: none;
    }
  }

  .document-grid-tile-label a {
    outline: none;
  }
}

.document-placeholder {
  @extend .placeholder;
  @extend .d-block;
}

.document-editor {
  .title-input, .react-tags {
    &:not(:focus):not(:focus-within):hover {
      @extend .dimmed;
    }
  }

  .title-input {
    @extend .h1;
    @extend .w-100;
    @extend .rounded-0;
    @extend .p-0;
    @extend .border-0;
    @extend .border-bottom;

    font-family: Georgia, "Times New Roman", serif;
    outline: none;
  }

  .react-tags {
    @extend .border-0;
    @extend .py-0;
    @extend .px-1;
    @extend .mx-n1;

    border-radius: 1rem;

    .keyword-tag {
      background-color: lighten($blue-100, 5%);
      border-radius: 1rem;

      &:hover, &:focus {
        background-color: $blue-100;
      }

      .btn-delete {
        background-color: lighten($blue-100, 5%);

        &:hover, &:focus {
          background-color: $blue-100;
        }
      }
    }

    .react-tags__search {
      @extend .mb-0;

      .react-tags__search-input {
        @extend .bg-transparent;
      }
    }

    .react-tags__suggestions {
      ul {
        @extend .dropdown-menu;
        @extend .show;

        li {
          @extend .dropdown-item;

          &.is-active {
            @extend .bg-primary;

            &, mark {
              @extend .text-white;
            }
          }

          mark {
            @extend .p-0;
            @extend .text-decoration-none;
          }
        }
      }
    }
  }

  [id^="trix-editor-top-level-"] {
    flex-grow: 1;
  }

  trix-editor {
    @extend .document-body;
  }
}

.document-body {
  @extend .h-100;
  @extend .m-0;
  @extend .pt-0;
  @extend .px-3;
  @extend .pb-3;
  @extend .rounded-0;

  font-family: Georgia, "Times New Roman", serif;
  font-size: 1.125em;
  border: none;
  outline: none;
  min-height: 80px;

  & > :last-child {
    margin-bottom: 0 !important;
  }

  h1:not(.title) {
    @extend .h3;
  }

  blockquote {
    @extend .p-3;

    border-left: 0.35em solid $secondary;
  }

  pre {
    @extend .card;
    @extend .card-body;
    @extend .bg-transparent;

    br {
      margin-top: 1em;
    }
  }

  a {
    cursor: pointer;
  }
}

.trix-toolbar {
  overflow-x: auto;
  white-space: nowrap;

  .btn-toolbar {
    &:hover, &:focus {
      @extend .dimmed;
    }

    &:not(.trix-active) {
      @extend .text-secondary;
    }

    &.trix-active {
      @extend .bg-primary;
      @extend .text-white;
    }
  }
}

.modal-body {
  .form-control, .btn {
    border-radius: 0.5rem;
  }
}

.project-list {
  .list-group-item {
    &:focus-within:not(:hover) {
      @extend .dimmed;
    }

    &:hover {
      @extend .active;
    }
  }

  .stretched-link {
    outline: none;
  }
}

#trix-dialogs {
  .trix-validate {
    @extend .is-invalid;
  }
}
